{"version":3,"file":"RadarProgress.js","sources":["../../src/components/RadarProgress.ts"],"sourcesContent":["import { RadarProgressOptions } from '../types';\nimport { ProgressBase } from '../base';\nimport { createElement, canvasContextCache } from '../utils';\n\n/**\n * RadarProgress - 雷达扫描进度条\n */\nexport class RadarProgress extends ProgressBase<RadarProgressOptions> {\n  private wrapper!: HTMLElement;\n  private canvas!: HTMLCanvasElement;\n  private ctx!: CanvasRenderingContext2D;\n  private animationId?: string;\n  private scanAngle: number = 0;\n  private textElement?: HTMLElement;\n\n  protected getDefaultOptions(): Partial<RadarProgressOptions> {\n    return {\n      ...super.getDefaultOptions(),\n      size: 200,\n      scanSpeed: 2,\n      radarColor: '#00ff00',\n      gridColor: 'rgba(0, 255, 0, 0.2)',\n      gridLines: 4,\n      showGrid: true,\n    };\n  }\n\n  protected render(): void {\n    this.container.innerHTML = '';\n\n    const size = this.config.get('size') ?? 200;\n\n    // 创建包装器\n    this.wrapper = createElement('div', 'ld-progress-radar', this.container);\n    this.wrapper.style.width = `${size}px`;\n    this.wrapper.style.height = `${size}px`;\n    this.wrapper.style.position = 'relative';\n    this.wrapper.style.backgroundColor = '#001a00';\n    this.wrapper.style.borderRadius = '50%';\n    this.wrapper.style.overflow = 'hidden';\n    this.wrapper.style.boxShadow = 'inset 0 0 20px rgba(0, 255, 0, 0.3)';\n\n    const className = this.config.get('className');\n    if (className) {\n      this.wrapper.classList.add(className);\n    }\n\n    // 创建 Canvas\n    this.canvas = createElement('canvas', 'ld-progress-radar__canvas', this.wrapper) as HTMLCanvasElement;\n    this.canvas.width = size;\n    this.canvas.height = size;\n\n    this.ctx = canvasContextCache.get(this.canvas);\n\n    // 创建文本\n    if (this.config.get('showText')) {\n      this.textElement = createElement('div', 'ld-progress-radar__text', this.wrapper);\n      this.textElement.style.position = 'absolute';\n      this.textElement.style.top = '50%';\n      this.textElement.style.left = '50%';\n      this.textElement.style.transform = 'translate(-50%, -50%)';\n      this.textElement.style.color = '#00ff00';\n      this.textElement.style.fontSize = '24px';\n      this.textElement.style.fontWeight = 'bold';\n      this.textElement.style.textShadow = '0 0 10px #00ff00';\n      this.textElement.style.zIndex = '10';\n    }\n\n    this.startAnimation();\n    this.updateProgress(this.currentValue);\n  }\n\n  /**\n   * 开始动画\n   */\n  private startAnimation(): void {\n    if (this.animationId) return;\n\n    const { rafController } = require('../utils/RAFController');\n    this.animationId = `radar-${this.id}`;\n\n    rafController.register(this.animationId, () => {\n      this.drawRadar();\n      const scanSpeed = this.config.get('scanSpeed') ?? 2;\n      this.scanAngle += scanSpeed;\n      if (this.scanAngle >= 360) {\n        this.scanAngle = 0;\n      }\n    }, 0);\n  }\n\n  /**\n   * 停止动画\n   */\n  private stopAnimation(): void {\n    if (this.animationId) {\n      const { rafController } = require('../utils/RAFController');\n      rafController.unregister(this.animationId);\n      this.animationId = undefined;\n    }\n  }\n\n  /**\n   * 绘制雷达\n   */\n  private drawRadar(): void {\n    if (!this.ctx) return;\n\n    const size = this.canvas.width;\n    const center = size / 2;\n    const percentage = this.config.getPercentage(this.currentValue);\n    const maxAngle = (360 * percentage) / 100;\n    const radarColor = this.config.get('radarColor') || '#00ff00';\n    const gridColor = this.config.get('gridColor') || 'rgba(0, 255, 0, 0.2)';\n\n    // 清除画布\n    this.ctx.clearRect(0, 0, size, size);\n\n    // 绘制网格\n    if (this.config.get('showGrid')) {\n      const gridLines = this.config.get('gridLines') ?? 4;\n      for (let i = 1; i <= gridLines; i++) {\n        const radius = (center * i) / gridLines;\n        this.ctx.beginPath();\n        this.ctx.arc(center, center, radius, 0, Math.PI * 2);\n        this.ctx.strokeStyle = gridColor;\n        this.ctx.lineWidth = 1;\n        this.ctx.stroke();\n      }\n    }\n\n    // 绘制扫描扇形（仅在进度范围内）\n    if (this.scanAngle <= maxAngle) {\n      this.ctx.save();\n      this.ctx.translate(center, center);\n      this.ctx.rotate((this.scanAngle * Math.PI) / 180);\n\n      // 扫描线\n      const gradient = this.ctx.createLinearGradient(0, 0, center, 0);\n      gradient.addColorStop(0, 'transparent');\n      gradient.addColorStop(0.7, radarColor + '80');\n      gradient.addColorStop(1, radarColor);\n\n      this.ctx.beginPath();\n      this.ctx.moveTo(0, 0);\n      this.ctx.lineTo(center, 0);\n      this.ctx.strokeStyle = radarColor;\n      this.ctx.lineWidth = 2;\n      this.ctx.stroke();\n\n      // 扇形扫描区域\n      this.ctx.beginPath();\n      this.ctx.moveTo(0, 0);\n      this.ctx.arc(0, 0, center, 0, Math.PI / 6);\n      this.ctx.closePath();\n      this.ctx.fillStyle = gradient;\n      this.ctx.fill();\n\n      this.ctx.restore();\n    }\n\n    // 绘制进度弧线\n    this.ctx.beginPath();\n    this.ctx.arc(\n      center,\n      center,\n      center - 5,\n      -Math.PI / 2,\n      (-Math.PI / 2 + (maxAngle * Math.PI) / 180)\n    );\n    this.ctx.strokeStyle = radarColor;\n    this.ctx.lineWidth = 3;\n    this.ctx.stroke();\n  }\n\n  protected updateProgress(value: number): void {\n    if (this.textElement) {\n      this.textElement.textContent = this.formatText(value);\n    }\n  }\n\n  /**\n   * 销毁\n   */\n  destroy(): void {\n    this.stopAnimation();\n    super.destroy();\n  }\n}\n\n\n\n"],"names":[],"mappings":"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"}