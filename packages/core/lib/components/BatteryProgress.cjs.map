{"version":3,"file":"BatteryProgress.cjs","sources":["../../src/components/BatteryProgress.ts"],"sourcesContent":["import { BatteryProgressOptions } from '../types';\r\nimport { ProgressBase } from '../base';\r\nimport { createElement, createSVGElement, toPx } from '../utils';\r\n\r\n/**\r\n * 电池样式进度条\r\n */\r\nexport class BatteryProgress extends ProgressBase<BatteryProgressOptions> {\r\n  private wrapper!: HTMLElement;\r\n  private battery!: HTMLElement;\r\n  private fill!: HTMLElement;\r\n  private head!: HTMLElement;\r\n  private boltIcon?: SVGElement;\r\n  private textElement?: HTMLElement;\r\n\r\n  protected getDefaultOptions(): Partial<BatteryProgressOptions> {\r\n    return {\r\n      ...super.getDefaultOptions(),\r\n      orientation: 'horizontal',\r\n      batteryWidth: 100,\r\n      batteryHeight: 50,\r\n      showBoltIcon: false,\r\n      chargingColor: '#67c23a',\r\n      lowBatteryThreshold: 20,\r\n      lowBatteryColor: '#f56c6c',\r\n    };\r\n  }\r\n\r\n  protected render(): void {\r\n    // 清空容器\r\n    this.container.innerHTML = '';\r\n\r\n    // 创建包装器\r\n    this.wrapper = createElement('div', 'ld-progress-battery', this.container);\r\n    const orientation = this.config.get('orientation') ?? 'horizontal';\r\n    this.wrapper.classList.add(`ld-progress-battery--${orientation}`);\r\n\r\n    // 添加自定义类名\r\n    const className = this.config.get('className');\r\n    if (className) {\r\n      this.wrapper.classList.add(className);\r\n    }\r\n\r\n    const width = this.config.get('batteryWidth') ?? 100;\r\n    const height = this.config.get('batteryHeight') ?? 50;\r\n\r\n    if (orientation === 'horizontal') {\r\n      this.wrapper.style.width = toPx(width);\r\n      this.wrapper.style.height = toPx(height);\r\n    } else {\r\n      this.wrapper.style.width = toPx(height);\r\n      this.wrapper.style.height = toPx(width);\r\n    }\r\n\r\n    this.wrapper.style.display = 'inline-flex';\r\n    this.wrapper.style.alignItems = 'center';\r\n    this.wrapper.style.position = 'relative';\r\n\r\n    // 创建电池主体\r\n    this.battery = createElement('div', 'ld-progress-battery__body', this.wrapper);\r\n    this.battery.style.flex = '1';\r\n    this.battery.style.height = '100%';\r\n    this.battery.style.border = '3px solid #909399';\r\n    this.battery.style.borderRadius = '4px';\r\n    this.battery.style.position = 'relative';\r\n    this.battery.style.overflow = 'hidden';\r\n    this.battery.style.backgroundColor = '#f5f5f5';\r\n\r\n    // 创建填充\r\n    this.fill = createElement('div', 'ld-progress-battery__fill', this.battery);\r\n    this.fill.style.position = 'absolute';\r\n    this.fill.style.bottom = '0';\r\n    this.fill.style.left = '0';\r\n    this.fill.style.height = '100%';\r\n    this.fill.style.transition = 'width 0.3s, background-color 0.3s';\r\n\r\n    // 创建电池头\r\n    this.head = createElement('div', 'ld-progress-battery__head', this.wrapper);\r\n    if (orientation === 'horizontal') {\r\n      this.head.style.width = '6px';\r\n      this.head.style.height = '40%';\r\n      this.head.style.backgroundColor = '#909399';\r\n      this.head.style.borderRadius = '0 3px 3px 0';\r\n    } else {\r\n      this.head.style.width = '40%';\r\n      this.head.style.height = '6px';\r\n      this.head.style.backgroundColor = '#909399';\r\n      this.head.style.borderRadius = '3px 3px 0 0';\r\n      this.head.style.order = '-1';\r\n    }\r\n\r\n    // 添加闪电图标\r\n    if (this.config.get('showBoltIcon')) {\r\n      this.renderBoltIcon();\r\n    }\r\n\r\n    // 创建文本\r\n    if (this.config.get('showText')) {\r\n      this.textElement = createElement('div', 'ld-progress-battery__text', this.battery);\r\n      this.textElement.style.position = 'absolute';\r\n      this.textElement.style.top = '50%';\r\n      this.textElement.style.left = '50%';\r\n      this.textElement.style.transform = 'translate(-50%, -50%)';\r\n      this.textElement.style.fontSize = '14px';\r\n      this.textElement.style.fontWeight = 'bold';\r\n      this.textElement.style.color = '#303133';\r\n      this.textElement.style.zIndex = '10';\r\n    }\r\n\r\n    // 更新进度\r\n    this.updateProgress(this.currentValue);\r\n  }\r\n\r\n  protected renderBoltIcon(): void {\r\n    const svg = createSVGElement('svg', {\r\n      width: '20',\r\n      height: '20',\r\n      viewBox: '0 0 24 24',\r\n      class: 'ld-progress-battery__bolt',\r\n    }) as SVGElement;\r\n\r\n    const path = createSVGElement('path', {\r\n      d: 'M13 2L3 14h8l-1 8 10-12h-8l1-8z',\r\n      fill: '#ffd43b',\r\n      stroke: '#f59e0b',\r\n      'stroke-width': '1',\r\n    });\r\n\r\n    svg.appendChild(path);\r\n    svg.style.position = 'absolute';\r\n    svg.style.top = '50%';\r\n    svg.style.left = '50%';\r\n    svg.style.transform = 'translate(-50%, -50%)';\r\n    svg.style.zIndex = '10';\r\n\r\n    this.battery.appendChild(svg);\r\n    this.boltIcon = svg;\r\n  }\r\n\r\n  protected updateProgress(value: number): void {\r\n    const percentage = this.config.getPercentage(value);\r\n    const orientation = this.config.get('orientation') ?? 'horizontal';\r\n    const lowThreshold = this.config.get('lowBatteryThreshold') ?? 20;\r\n    const lowColor = this.config.get('lowBatteryColor') ?? '#f56c6c';\r\n    const chargingColor = this.config.get('chargingColor') ?? '#67c23a';\r\n\r\n    // 更新填充宽度/高度\r\n    if (orientation === 'horizontal') {\r\n      this.fill.style.width = `${percentage}%`;\r\n      this.fill.style.height = '100%';\r\n    } else {\r\n      this.fill.style.width = '100%';\r\n      this.fill.style.height = `${percentage}%`;\r\n    }\r\n\r\n    // 根据电量改变颜色\r\n    let fillColor: string;\r\n    if (percentage <= lowThreshold) {\r\n      fillColor = lowColor;\r\n    } else if (this.config.get('showBoltIcon')) {\r\n      fillColor = chargingColor;\r\n    } else {\r\n      const color = this.config.get('color');\r\n      fillColor = Array.isArray(color) ? color[0] : (color || '#67c23a');\r\n    }\r\n\r\n    this.fill.style.backgroundColor = fillColor;\r\n\r\n    // 低电量时添加脉冲动画\r\n    if (percentage <= lowThreshold && percentage > 0) {\r\n      this.fill.style.animation = 'battery-pulse 1.5s infinite';\r\n    } else {\r\n      this.fill.style.animation = 'none';\r\n    }\r\n\r\n    // 更新文本\r\n    if (this.textElement) {\r\n      this.textElement.textContent = this.formatText(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 设置方向\r\n   */\r\n  setOrientation(orientation: 'horizontal' | 'vertical'): void {\r\n    this.config.set('orientation', orientation);\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n   * 设置充电状态\r\n   */\r\n  setCharging(charging: boolean): void {\r\n    this.config.set('showBoltIcon', charging);\r\n    if (charging && !this.boltIcon) {\r\n      this.renderBoltIcon();\r\n    } else if (!charging && this.boltIcon) {\r\n      this.boltIcon.remove();\r\n      this.boltIcon = undefined;\r\n    }\r\n    this.updateProgress(this.currentValue);\r\n  }\r\n}\r\n\r\n\r\n"],"names":["ProgressBase","createElement","toPx","createSVGElement"],"mappings":"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"}